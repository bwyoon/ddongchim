<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ì´ˆê°•ë ¥ ë˜¥ì¹¨ ê²Œì„</title>
    <style>
        body { margin: 0; background-color: #f0f0f0; display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100vh; font-family: 'Arial', sans-serif; overflow: hidden; }
        canvas { background: #fff; border: 5px solid #333; box-shadow: 0 0 20px rgba(0,0,0,0.2); }
        .info { margin-bottom: 10px; text-align: center; }
        .stats { font-size: 20px; font-weight: bold; color: #333; }
        .controls { margin-top: 10px; color: #666; font-size: 14px; }
    </style>
</head>
<body>

    <div class="info">
        <h1>ğŸ¯ ì´ˆê°•ë ¥ ë˜¥ì¹¨ ê²Œì„</h1>
        <div class="stats">ì ìˆ˜: <span id="score">0</span> | ë‚¨ì€ ì‹œê°„: <span id="timer">30</span>ì´ˆ</div>
    </div>

    <canvas id="gameCanvas" width="500" height="600"></canvas>

    <div class="controls">
        [â†][â†’] ë°©í–¥í‚¤: ì´ë™ | [Space]: ë˜¥ì¹¨ ë°œì‚¬!
    </div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const scoreElement = document.getElementById('score');
        const timerElement = document.getElementById('timer');

        // ê²Œì„ ì„¤ì •
        let score = 0;
        let timeLeft = 30;
        let isGameOver = false;

        // ì—‰ë©ì´ ì„¤ì •
        const butt = {
            x: 250,
            y: 150,
            width: 100,
            height: 60,
            dx: 3, // ì†ë„
            direction: 1
        };

        // ì† ì„¤ì •
        const hand = {
            x: 250,
            y: 530,
            width: 40,
            height: 60,
            isAttacking: false,
            targetY: 530,
            originY: 530
        };

        // í‚¤ ì…ë ¥ ìƒíƒœ
        const keys = {};

        window.addEventListener('keydown', e => keys[e.code] = true);
        window.addEventListener('keyup', e => keys[e.code] = false);

        // ê³µê²© ë¡œì§ (ìŠ¤í˜ì´ìŠ¤ë°”)
        window.addEventListener('keydown', e => {
            if (e.code === 'Space' && !hand.isAttacking && !isGameOver) {
                launchAttack();
            }
        });

        function launchAttack() {
            hand.isAttacking = true;
            
            // 0.2ì´ˆ ë™ì•ˆ ìƒìŠ¹
            const attackDuration = 200; 
            const targetY = butt.y + 30;

            // ì• ë‹ˆë©”ì´ì…˜: ìœ„ë¡œ ì°Œë¥´ê¸°
            let startTime = null;
            function animateAttack(timestamp) {
                if (!startTime) startTime = timestamp;
                let progress = timestamp - startTime;

                if (progress < attackDuration) {
                    // ì˜¬ë¼ê°€ëŠ” ì¤‘
                    hand.y = hand.originY - (hand.originY - targetY) * (progress / attackDuration);
                    requestAnimationFrame(animateAttack);
                } else {
                    // ì •ì  ë„ë‹¬ - íŒì •
                    checkHit();
                    // 0.2ì´ˆ í›„ ë³µê·€
                    setTimeout(() => {
                        returnToOrigin();
                    }, 100);
                }
            }
            requestAnimationFrame(animateAttack);
        }

        function returnToOrigin() {
            let startTime = null;
            function animateBack(timestamp) {
                if (!startTime) startTime = timestamp;
                let progress = timestamp - startTime;

                if (progress < 200) {
                    hand.y = (butt.y + 30) + (hand.originY - (butt.y + 30)) * (progress / 200);
                    requestAnimationFrame(animateBack);
                } else {
                    hand.y = hand.originY;
                    hand.isAttacking = false;
                }
            }
            requestAnimationFrame(animateBack);
        }

        function checkHit() {
            // í•­ë¬¸ ë²”ìœ„ íŒì • (ì—‰ë©ì´ì˜ ì¤‘ì•™ ë¶€ë¶„)
            const margin = 20; 
            if (hand.x > butt.x - margin && hand.x < butt.x + margin) {
                score += 10;
                butt.dx += 0.5; // ì„±ê³µ ì‹œ ë‚œì´ë„ ìƒìŠ¹ (ì†ë„ ì¦ê°€)
                ctx.fillStyle = 'red'; // í”¼ë“œë°± íš¨ê³¼ìš© ìƒ‰ìƒ ë³€ê²½
            } else {
                score -= 5;
            }
            scoreElement.innerText = score;
        }

        function drawButt() {
            ctx.save();
            ctx.translate(butt.x, butt.y);
            
            // ì—‰ë©ì´ ì–‘ìª½ ë°˜ì›
            ctx.fillStyle = '#FFDAB9';
            ctx.beginPath();
            ctx.arc(-25, 0, 35, 0, Math.PI * 2);
            ctx.arc(25, 0, 35, 0, Math.PI * 2);
            ctx.fill();

            // í•­ë¬¸ í‘œì‹œ (ëª©í‘œ ì§€ì )
            ctx.fillStyle = '#EB9694';
            ctx.beginPath();
            ctx.arc(0, 0, 8, 0, Math.PI * 2);
            ctx.fill();
            ctx.restore();
        }

        function drawHand() {
            ctx.save();
            ctx.translate(hand.x, hand.y);
            
            // ê¹ì§€ ë‚€ ì† ë­‰ì¹˜
            ctx.fillStyle = '#FFDAB9';
            ctx.fillRect(-15, 0, 30, 40);
            
            // ì„¸ìš´ ë‘ ê²€ì§€
            ctx.strokeStyle = '#FFDAB9';
            ctx.lineWidth = 8;
            ctx.lineCap = 'round';
            ctx.beginPath();
            ctx.moveTo(-5, 0);
            ctx.lineTo(-5, -30);
            ctx.moveTo(5, 0);
            ctx.lineTo(5, -30);
            ctx.stroke();
            
            ctx.restore();
        }

        function update() {
            if (isGameOver) return;

            // ì—‰ë©ì´ ì›€ì§ì„ (ë‚œì´ë„ ë°˜ì˜)
            butt.x += butt.dx * butt.direction;
            if (butt.x > canvas.width - 50 || butt.x < 50) {
                butt.direction *= -1;
            }

            // ì† ì´ë™
            if (keys['ArrowLeft'] && hand.x > 30) hand.x -= 7;
            if (keys['ArrowRight'] && hand.x < canvas.width - 30) hand.x += 7;
        }

        function draw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            drawButt();
            drawHand();
            
            if (!isGameOver) {
                update();
                requestAnimationFrame(draw);
            }
        }

        // íƒ€ì´ë¨¸ ë£¨í”„
        const gameTimer = setInterval(() => {
            if (timeLeft > 0) {
                timeLeft--;
                timerElement.innerText = timeLeft;
            } else {
                isGameOver = true;
                clearInterval(gameTimer);
                alert(`ê²Œì„ ì¢…ë£Œ! ë‹¹ì‹ ì˜ ìµœì¢… ì ìˆ˜ëŠ” ${score}ì ì…ë‹ˆë‹¤.`);
                location.reload();
            }
        }, 1000);

        draw();
    </script>
</body>
</html>